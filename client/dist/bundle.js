(function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={i:d,l:!1,exports:{}};return a[d].call(e.exports,e,e.exports,b),e.l=!0,e.exports}var c={};return b.m=a,b.c=c,b.d=function(a,c,d){b.o(a,c)||Object.defineProperty(a,c,{configurable:!1,enumerable:!0,get:d})},b.n=function(a){var c=a&&a.__esModule?function(){return a['default']}:function(){return a};return b.d(c,'a',c),c},b.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},b.p='',b(b.s=3)})([function(a){a.exports={COMMENT:'COMMENT',CREATE:'CREATE',DELETE_COMMENT:'DELETE_COMMENT',DELETE_POST:'DELETE_POST',UPDATE:'UPDATE',VOTE:'VOTE',TRENDING:'TRENDING',TOP:'TOP',NEW:'NEW',PLANNED:'PLANNED',IN_PROGRESS:'IN_PROGRESS',OPEN:'OPEN',CLOSED:'CLOSED',COMPLETE:'COMPLETE'}},function(a){a.exports=(a)=>a&&a.userId&&0!==a.userId.indexOf('guest:')},function(a,b,c){const d=c(1);a.exports=(a)=>d(a)&&a.admin},function(a,b,c){c(4),a.exports=c(8)},function(a,b,c){'use strict';function d(a,b){for(var c,d=[],e=[],f=arguments.length;2<f--;)d.push(arguments[f]);for(;d.length;)if(Array.isArray(c=d.pop()))for(f=c.length;f--;)d.push(c[f]);else if(null==c||!0===c||!1===c);else e.push('number'==typeof c?c+='':c);return'string'==typeof a?{type:a,props:b||{},children:e}:a(b||{},e)}Object.defineProperty(b,'__esModule',{value:!0});const e=(a,b,c)=>{const d=a.map((a)=>a(b)),e=d.reverse();return e.reduce((a,b)=>b(a),c)},f=()=>{let a=[];return{subscribe:(b)=>(a.push(b),()=>{a=a.filter((a)=>a!==b)}),publish:(...b)=>{a.forEach((a)=>a(...b))}}},g=(a,b=void 0,c=[])=>{let d,g=a(b,{});const h=f(),i=(b)=>{g=a(g,b),h.publish(g,b)},j={dispatch:(a)=>{d(a)},getState:()=>g,subscribe:h.subscribe};return((a)=>{d=e(a,j,i)})(c),j},h=(a,b)=>{Object.keys(a).forEach((c)=>b(a[c],c))},i=(a,b,c)=>(h(a,(a,d)=>c=b(c,a,d)),c),j=(a)=>(b={},c)=>i(a,(a,b,d)=>Object.assign({},a,{[d]:b(a[d],c)}),b),k=(a,b='')=>b?(Array.isArray(b)||(b=b.split('.')),b.reduce((a,b)=>a?a[b]:void 0,a)):a,l=(a,b)=>(c={},d)=>{const e=k(d,b);if(!e)return c;const f=a(c[e],d),g=Object.assign({},c);return void 0===f?delete g[e]:g[e]=f,g},m='patcher/SET',n='jiber/JOIN_ROOM',o='jiber/LEAVE_ROOM',p='jiber/CONFIRMED_STATE',q='jiber/LOGIN_RESULT',r='jiber/WEBRTC_OFFER',s='jiber/WEBRTC_ANSWER',t='jiber/WEBRTC_CANDIDATE',u='SERVER',v='SELF',w=l((a,b)=>{switch(b.type){case n:return Object.assign({},b.$user);case o:return;default:if(!a)return a;if(!b.$confirmed)return a;const c=b.$actionId||0,d=a.actionId||0;return c<=d?a:Object.assign({},a,{actionId:c});}},'$userId'),x=(a={},b)=>b.type===p&&b.$source===u?b.members:w(a,b),y=(a=0,b)=>b.$timeMs||a,z=(a)=>(b=void 0,c)=>{switch(c.type){case p:return c.confirmed;default:return c.$confirmed?a(b,c):b;}},A=(a)=>{const b=j({members:x,lastUpdatedAt:y,confirmed:z(a)});return(a,c)=>{switch(c.type){case'jiber/CLOSE_ROOM':return;default:return b(a,c);}}},B=(a,b,c)=>{if(!b)return c;if(Array.isArray(b)||(b=b.split('.')),0===b.length)return c;const[d,...e]=b,f=a[d]||{},g=B(f,e,c);if(Array.isArray(a)){const b=[...a];return b[+d]=g,b}return Object.assign({},a,{[d]:g})},C=(a,b)=>{const c={};return h(a,(a,d)=>c[d]=b(a,d)),c},D=(a)=>()=>(b)=>(c)=>{c.$confirmed||c.$userId||a(c),b(c)};let E=1;const F=()=>(a)=>(b)=>(b.$actionId||(b.$actionId=E++),a(b));let G=1;const H=(a)=>(b)=>(c)=>{const d=c.$roomId,e=a.getState();if(!d||!e.rooms[d])return b(c);if(c.$actionId||(c.$actionId=G++),c.$timeMs||(c.$timeMs=new Date().getTime()),c.$source||(c.$source=v),c.$userId){const a=e.rooms[d];c.$user=a.members[c.$userId]||c.$user}else e.me&&(c.$userId=e.me.userId,c.$user=e.me);return b(c)},I=(a)=>{const{url:b,credential:c,backoffMs:d}=a;return b?new Promise((a)=>{const e=(b)=>{delete b.onclose,delete b.onopen,a(b)},f=(a=0)=>{setTimeout(()=>{const d=new WebSocket(b,c);d.onclose=()=>f(a+1),d.onopen=()=>e(d)},a*d)};f()}):Promise.reject('NO_URL')};var J=this&&this.__awaiter||function(a,b,c,d){return new(c||(c=Promise))(function(e,f){function g(a){try{i(d.next(a))}catch(a){f(a)}}function h(a){try{i(d['throw'](a))}catch(a){f(a)}}function i(a){a.done?e(a.value):new c(function(b){b(a.value)}).then(g,h)}i((d=d.apply(a,b||[])).next())})};const K=(a)=>{let b;const c={send:(a)=>{b&&b.readyState===b.OPEN&&b.send(a)}},d=()=>J(this,void 0,void 0,function*(){b=yield I(a),c.onmessage&&(b.onmessage=c.onmessage),b.onclose=()=>setTimeout(d,3e3)});return d(),c},L=(a,b)=>C(b,(b)=>(...c)=>a(b(...c))),M=(a,b={})=>(c)=>{const d=()=>{const b=a.getState();return b.rooms[c]},e=(b)=>{a.dispatch(Object.assign({},b,{$roomId:c}))},g=L(e,b);e({type:n});const h=f();return a.subscribe((a,b)=>{b&&b.$roomId===c&&h.publish(a.rooms[c].optimistic,b)}),Object.assign({},g,{dispatch:e,getState:()=>k(d(),'optimistic'),getConfirmedState:()=>k(d(),'confirmed'),subscribe:h.subscribe})},N={reducer:(a={},b)=>{switch(b.type){case m:return'object'==typeof b.set?Object.assign({},a,b.set):a;default:return a;}},middleware:[],url:void 0,stunServers:['stun:stun.jiber.io'],credential:void 0,initialState:void 0,backoffMs:5e3,actionCreators:{set:(a)=>({type:m,set:a})},maxPeers:10},O=(a,b)=>a.filter((a)=>!!a.$userId&&(a.$userId!==b.$userId||(a.$actionId||0)>(b.$actionId||0))),P=(a,b)=>b.type===n||b.type===o?a:b.$user?(b.$actionId||0)>(b.$user.actionId||0)?[...a,b]:a:[...a,b],Q=(a=[],b)=>{switch(b.type){case p:return[];case o:return a.filter((a)=>a.$userId!==b.$userId);default:return b.$confirmed?O(a,b):P(a,b);}},R=(a)=>(b,c)=>{const d=b.optimistic;if(c.type===p){const{pendingActions:c}=b;return c.reduce(a,b.confirmed)}const e=k(c,'$user.actionId')||0,f=c.$actionId||0;if(c.$confirmed){const{pendingActions:c,confirmed:d}=b;return c.reduce(a,d)}return f>e?a(d,c):d},S={lastUpdatedAt:0,members:{},confirmed:void 0,optimistic:void 0,pendingActions:[]},T=(a)=>{const b=A(a),c=R(a);return(a=S,d)=>{const e=b(a,d);return e.pendingActions=Q(e.pendingActions,d),e.optimistic=c(e,d),e}},U=(a={userId:'$timeMsemp'},b)=>{switch(b.type){case q:return b.user;default:return a;}},V=(a)=>{const b=T(a),c=l(b,'$roomId'),d=j({rooms:c,me:U});return d},W=(a,b)=>{let c;const d={send:(a)=>{if(c&&'open'===c.readyState){const b=Object.assign({},a,{$user:void 0,$userId:void 0,$timeMs:void 0});c.send(JSON.stringify(b))}}},e=(a)=>{a.onmessage=(a)=>{d.onmessage&&d.onmessage(a)}};if(b){c=a.createDataChannel('data',{ordered:!1,maxRetransmits:0}),e(c)}else a.ondatachannel=(a)=>{c=a.channel,e(c)};return d},X=(a,b,c)=>{if(!c.$roomId)return!1;if(c.$source!==v)return!1;const d=a.rooms[c.$roomId];return!!d.members[b]},Y=(a)=>console.log(a);var Z=this&&this.__awaiter||function(a,b,c,d){return new(c||(c=Promise))(function(e,f){function g(a){try{i(d.next(a))}catch(a){f(a)}}function h(a){try{i(d['throw'](a))}catch(a){f(a)}}function i(a){a.done?e(a.value):new c(function(b){b(a.value)}).then(g,h)}i((d=d.apply(a,b||[])).next())})};const $=(a,b,c,d)=>{const e=(b)=>Z(this,void 0,void 0,function*(){const d=yield b.createAnswer();yield b.setLocalDescription(d),a({type:s,answer:d,peerUserId:c})}),f=(b)=>{a({type:t,candidate:b,peerUserId:c})};return b.onicecandidate=(a)=>{a.candidate&&f(a.candidate)},d?((a)=>Z(this,void 0,void 0,function*(){return yield b.setRemoteDescription(a),e(b)}))(d).catch(Y):(()=>Z(this,void 0,void 0,function*(){const d=yield b.createOffer();yield b.setLocalDescription(d),a({type:r,offer:d,peerUserId:c})}))().catch(Y),{onAction:(a)=>Z(this,void 0,void 0,function*(){if(a.$confirmed&&a.$userId===c)switch(a.type){case s:return b.setRemoteDescription(a.answer);case t:return b.addIceCandidate(a.candidate);}})}},_=(a,b,c)=>{const d=JSON.parse(c.data),e=d.$roomId;if(e){const c=a.getState().rooms[e],f=c.members,g=f[b];g&&(d.$timeMs=new Date().getTime(),d.$userId=b,d.$source='PEER',d.$user=g,a.dispatch(d))}},aa=(a)=>{const b={iceServers:a.map((a)=>({urls:a}))};return new RTCPeerConnection(b)},ba=(a,b,c,d)=>{const e=aa(c.stunServers),f=W(e,!d),g=$(b.dispatch,e,a,d);f.onmessage=(c)=>{_(b,a,c)};const h=b.subscribe((c)=>{g.onAction(c).catch(Y);const d=b.getState();X(d,a,c)&&f.send(c)});return{peerUserId:a,close:()=>{h(),e.close()}}},ca=()=>{const a=window;['RTCPeerConnection','RTCIceCandidate','RTCSessionDescription'].forEach((b)=>{a[b]=a[b]||a[`moz${b}`]||a[`webkit${b}`]})},da=(a,b)=>{ca();const c={},d=(a)=>i(a.rooms,(a,b)=>Object.assign(a,b.members),{}),e=(a)=>{const b=c[a];b&&(b.close(),delete c[a])},f=()=>{const b=d(a.getState());h(c,(a)=>{b[a.peerUserId]||e(a.peerUserId)})},g=(d,e)=>{c[d]||Object.keys(c).length>=b.maxPeers||(c[d]=ba(d,a,b,e))};a.subscribe((b)=>{if(b.$confirmed)switch(b.type){case o:return f();case n:return b.$userId?b.$userId===a.getState().me.userId?void 0:g(b.$userId):void 0;case r:return b.$userId?g(b.$userId,b.offer):void 0;}})},ea=(a,b,c)=>{switch(c.type){case q:{const c=b();return void h(c.rooms,(b,c)=>{a({type:n,$roomId:c})})}case p:{if(!c.$roomId)return;const d=b(),e=d.rooms[c.$roomId];return void(e&&e.pendingActions.forEach(a))}}};var fa=c(5),ga=c.n(fa),ha={roomId:window.upsenseRoomId||'test',baseUrl:window.upsenseBaseUrl||'http://localhost:3000//feedback',host:window.upsenseHost||`${window.location.protocol}//${window.location.host}`};const ia=ha.host.replace('https:','wss:').replace('http:','ws:')+'/ws',ja=((a={})=>{const b=Object.assign({},N,a),c=V(b.reducer),d=K(b),e=(a)=>d.send(JSON.stringify(a)),f=D(e),h=[...b.middleware,F,f,H],i=g(c,b.initialState,h),j=M(i,b.actionCreators),k=Object.assign({},i,{createRoom:j});return d.onmessage=(a)=>{const b=JSON.parse(a.data);b.$confirmed=!0,b.$source=u,ea(e,i.getState,b),i.dispatch(b)},da(i,b),k})({url:ia,reducer:ga.a,maxPeers:0}),ka=ja.createRoom(ha.roomId);var la=({createPost:a,goto:b})=>d('div',{class:'post-create'},d('div',{class:'top'},d('h2',null,'Create a Post'),d('button',{class:'btn btn-text',onclick:()=>b('/')},'See All Posts')),d('div',{class:'fake-field'},d('div',{class:'title'},'Title'),d('input',{class:'input',id:'title-field',type:'text',placeholder:'Short, descriptive title'})),d('div',{class:'fake-field'},d('div',{class:'title'},'Details'),d('textarea',{class:'input',id:'description-field',placeholder:'Any additional details...',rows:'3'})),d('button',{class:'btn btn-text btn-primary create-post',onclick:()=>a({title:document.getElementById('title-field').value,description:document.getElementById('description-field').value})},'Create Post')),ma=c(0),na=c.n(ma),oa=(a)=>d('div',{class:'sm-post'},d('div',{class:'vote',onclick:()=>a.vote(a.postId)},d('div',{class:'arrow-up'}),a.total),d('div',{class:'content',onclick:()=>a.goto(`/posts/${a.postId}`)},d('div',{class:'title'},a.title,a.status===ma.OPEN?'':d('span',{class:'status'},a.status)),d('div',{class:'description'},a.description)),d('div',{class:'comments',onclick:()=>a.goto(`/posts/${a.postId}`)},d('svg',{fill:'#ccc',height:'24',width:'24'},d('path',{d:'M21.99 4c0-1.1-.89-2-1.99-2H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h14l4 4-.01-18zM18 14H6v-2h12v2zm0-3H6V9h12v2zm0-3H6V6h12v2z'}),d('path',{d:'M0 0h24v24H0z',fill:'none'})),d('span',{class:'comment-count'},a.comments?a.comments.length:0)));const pa=[ma.PLANNED,ma.IN_PROGRESS,ma.OPEN],qa=(a,b)=>{Array.isArray(b)||(b=[b]);const c=a.filter((a)=>-1!==b.indexOf(a.status));return c},ra=(a)=>{const b=a.map((a)=>{const b=new Date().getTime()-new Date(a.createdAt).getTime(),c=a.total/(b/1e3/60/60/24);return Object.assign({},a,{trendScore:c})});return sa(b,'trendScore')},sa=(a,c)=>ta(a,(d,a)=>d[c]<a[c]?1:d[c]>a[c]?-1:0),ta=(a,b)=>{const c=[...a];return c.sort(b),c},ua={[ma.TRENDING]:(a)=>ra(qa(a,pa)),[ma.TOP]:(a)=>sa(qa(a,pa),'total'),[ma.NEW]:(a)=>sa(qa(a,pa),'createdAt'),[ma.PLANNED]:(a)=>qa(a,ma.PLANNED),[ma.IN_PROGRESS]:(a)=>qa(a,ma.IN_PROGRESS),[ma.OPEN]:(a)=>qa(a,ma.OPEN),[ma.CLOSED]:(a)=>qa(a,ma.CLOSED),[ma.COMPLETE]:(a)=>qa(a,ma.COMPLETE)};var va=Object.assign||function(a){for(var b,c=1;c<arguments.length;c++)for(var d in b=arguments[c],b)Object.prototype.hasOwnProperty.call(b,d)&&(a[d]=b[d]);return a},wa=({posts:a,vote:b,goto:c,sort:e})=>{if(!a)return d('span',null,'No posts yet...');const f=Object.values(a),g=ua[e],h=g(f);return 0<h.length?d('ul',{class:'post-list'},h.map((a)=>d('li',null,d(oa,va({},a,{vote:b,goto:c}))))):d('span',null,'No posts yet...')},xa=({admin:a,user:b,text:c,deleteComment:e})=>d('div',{class:'comment'},d('div',{class:'name'},b.name||b.userId),d('div',{class:'text'},c,a?d('span',{class:'btn btn-inline',onclick:e},'delete'):'')),ya=c(2),za=c.n(ya),Aa=Object.assign||function(a){for(var b,c=1;c<arguments.length;c++)for(var d in b=arguments[c],b)Object.prototype.hasOwnProperty.call(b,d)&&(a[d]=b[d]);return a},Ba=({me:a,post:b,goto:c,vote:e,addComment:f,deleteComment:g,deletePost:h,editPost:i})=>{return d('div',{class:'post-inspect'},d('button',{class:'btn btn-text',onclick:()=>c('/')},'Back to All Posts'),(()=>za()(a)?d('span',{class:'admin-buttons'},d('button',{class:'btn btn-text',onclick:()=>c(`/edit/${b.postId}`)},'Edit'),d('button',{class:'btn btn-text',onclick:()=>h(b.postId)},'Delete')):d('span',null))(),d('div',{class:'top'},d('div',{class:'vote',onclick:()=>e(b.postId)},d('div',{class:'arrow-up'}),b.total),d('div',{class:'title'},b.title)),d(xa,{user:b.owner,text:b.description,deleteComment:()=>{}}),b.comments.map((c,e)=>d(xa,Aa({},c,{admin:za()(a),deleteComment:()=>g(b.postId,e)}))),d('input',{id:'comment-box',type:'text',placeholder:'Add a comment...',onkeydown:(a)=>{if(13===a.keyCode){const a=document.getElementById('comment-box'),c=a.value;a.value='',f({postId:b.postId,text:c})}}}))},Ca=({post:a,updatePost:b,goto:c})=>d('div',{class:'post-create'},d('div',{class:'top'},d('h2',null,'Update Post'),d('button',{class:'btn btn-text',onclick:()=>c('/')},'See All Posts')),d('div',{class:'fake-field'},d('div',{class:'title'},'Title'),d('input',{class:'input',id:'title-field',type:'text',placeholder:'Short, descriptive title',value:a.title})),d('div',{class:'fake-field'},d('div',{class:'title'},'Details'),d('textarea',{class:'input',id:'description-field',placeholder:'Any additional details...',rows:'3',value:a.description})),d('select',{id:'status-field',value:a.status},d('option',{value:na.a.PLANNED},'Planned'),d('option',{value:na.a.IN_PROGRESS},'In Progress'),d('option',{value:na.a.OPEN},'Open'),d('option',{value:na.a.COMPLETE},'Complete'),d('option',{value:na.a.CLOSED},'Closed')),d('button',{class:'btn btn-text btn-primary create-post',onclick:()=>b({postId:a.postId,title:document.getElementById('title-field').value,description:document.getElementById('description-field').value,status:document.getElementById('status-field').value})},'Update Post')),Da=c(1),Ea=c.n(Da),Fa=({goto:a,updateSort:b,me:c})=>d('div',{class:'controls'},d('div',{class:'showing'},'Showing \xA0',d('select',{onchange:b},d('option',{value:na.a.TRENDING},'Trending'),d('option',{value:na.a.TOP},'Top'),d('option',{value:na.a.NEW},'New'),d('option',{value:na.a.PLANNED},'Planned'),d('option',{value:na.a.IN_PROGRESS},'In Progress'),d('option',{value:na.a.OPEN},'Open'),d('option',{value:na.a.COMPLETE},'Complete'),d('option',{value:na.a.CLOSED},'Closed'))),d('div',{class:'group'},d('button',{class:'btn btn-primary',onclick:()=>Ea()(c)?a('/create'):a('/login')},d('svg',{height:'24',width:'24',xmlns:'http://www.w3.org/2000/svg'},d('path',{d:'M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z'}),d('path',{d:'M0 0h24v24H0z',fill:'none'}))))),Ga=()=>d('div',{class:'login'},d('h2',null,'Click a Site to Login'),d('a',{href:`${ha.host}/auth/twitter`},d('svg',{id:'Logo_FIXED',"data-name":'Logo \u2014 FIXED',xmlns:'http://www.w3.org/2000/svg',viewBox:'0 0 400 400'},d('defs',null,d('style',null,'.cls-1{fill:none;}.cls-2{fill:#1da1f2;}')),d('title',null,'Twitter_Logo_Blue'),d('rect',{class:'cls-1',width:'400',height:'400'}),d('path',{class:'cls-2',d:'M153.62,301.59c94.34,0,145.94-78.16,145.94-145.94,0-2.22,0-4.43-.15-6.63A104.36,104.36,0,0,0,325,122.47a102.38,102.38,0,0,1-29.46,8.07,51.47,51.47,0,0,0,22.55-28.37,102.79,102.79,0,0,1-32.57,12.45,51.34,51.34,0,0,0-87.41,46.78A145.62,145.62,0,0,1,92.4,107.81a51.33,51.33,0,0,0,15.88,68.47A50.91,50.91,0,0,1,85,169.86c0,.21,0,.43,0,.65a51.31,51.31,0,0,0,41.15,50.28,51.21,51.21,0,0,1-23.16.88,51.35,51.35,0,0,0,47.92,35.62,102.92,102.92,0,0,1-63.7,22A104.41,104.41,0,0,1,75,278.55a145.21,145.21,0,0,0,78.62,23'})))),Ha=Object.assign||function(a){for(var b,c=1;c<arguments.length;c++)for(var d in b=arguments[c],b)Object.prototype.hasOwnProperty.call(b,d)&&(a[d]=b[d]);return a},Ia=({state:a,actions:b})=>{if('/create'===a.path)return d(la,{goto:b.goto,createPost:b.createPost});if('/login'===a.path)return d(Ga,null);if(0===a.path.indexOf('/posts/')){const c=a.path.substr(7);if(a.posts&&a.posts[c])return d(Ba,Ha({me:a.me,post:a.posts[c]},b))}else if(0===a.path.indexOf('/edit/')){const c=a.path.substr(6);if(a.posts&&a.posts[c])return d(Ca,Ha({post:a.posts[c]},b))}return d('div',null,d(Fa,Ha({me:a.me},b)),d(wa,Ha({sort:a.sort,posts:a.posts},b)))},Ja=({me:a,goto:b})=>Ea()(a)?d('div',{class:'current-user'},a.name,d('a',{class:'btn btn-inline',href:`${ha.host}/logout`},'logout')):d('div',{class:'current-user'},d('span',{class:'btn btn-inline',onclick:()=>b('/login')},'login'));let Ka;const La=(a)=>{window.history.pushState(void 0,a,`${ha.baseUrl}${a}`),Ka&&Ka.setPath(a)},Ma=(a)=>0===a.indexOf(ha.baseUrl)?a.substr(ha.baseUrl.length):a,Na={createPost:({title:a,description:b})=>{const c=a.replace(/\W/g,'-').toLowerCase();3<c.length&&(ka.dispatch({type:ma.CREATE,title:a,postId:c,description:b}),ka.dispatch({type:ma.VOTE,postId:c}),La(`/posts/${c}`))},deleteComment:(a,b)=>{const c=ja.getState();za()(c.me)&&ka.dispatch({type:ma.DELETE_COMMENT,postId:a,index:b})},deletePost:(a)=>{const b=ja.getState();za()(b.me)&&(ka.dispatch({type:ma.DELETE_POST,postId:a}),La('/'))},updatePost:({postId:a,title:b,description:c,status:d})=>{const e=ja.getState();za()(e.me)&&(ka.dispatch({type:ma.UPDATE,postId:a,title:b,description:c,status:d}),La('/'))},vote:(a)=>{const b=ja.getState();Ea()(b.me)?ka.dispatch({type:ma.VOTE,postId:a}):La('/login')},addComment:({postId:a,text:b})=>{const c=ja.getState();return Ea()(c.me)?void ka.dispatch({type:ma.COMMENT,postId:a,text:b}):La('/login')},goto:La};const Oa={me:void 0,posts:ka.getState(),sort:ma.TRENDING,path:'/'},Pa=document.getElementById('upsense'),Qa=function(a,b){function c(a,b){return a&&d(a.tagName.toLowerCase(),{},b.call(a.childNodes,function(a){return 3===a.nodeType?a.nodeValue:c(a,b)}))}function e(a,b){for(var c in b)a[c]=b[c];return a}function f(a,b){return e(e({},a),b)}function g(a,b,c){var d={};return 0===a.length?b:(d[a[0]]=1<a.length?g(a.slice(1),b,c[a[0]]):b,f(c,d))}function h(a,b){for(var c=0;c<a.length;c++)b=b[a[c]];return b}function i(a){return'function'==typeof a}function j(a,b,c,d){for(var e in c)i(c[e])?function(c,e){b[c]=function(c){return a=h(d,w),i(c=e(c))&&i(c=c(a))&&(c=c(b)),c&&c!==a&&!c.then&&r(w=g(d,f(a,c),w)),c}}(e,c[e]):j(a[e]||(a[e]={}),b[e]={},c[e],d.concat(e))}function k(a){if(a&&a.props)return a.props.key}function l(a,b,c,d){if('key'===b);else if('style'===b)for(var e in f(d,c=c||{}))a.style[e]=null==c[e]?'':c[e];else{try{a[b]=null==c?'':c}catch(a){}i(c)||(null==c||!1===c?a.removeAttribute(b):a.setAttribute(b,c))}}function m(a,b){if('string'==typeof a)var c=document.createTextNode(a);else{var c=(b=b||'svg'===a.type)?document.createElementNS('http://www.w3.org/2000/svg',a.type):document.createElement(a.type);a.props.oncreate&&v.push(function(){a.props.oncreate(c)});for(var d=0;d<a.children.length;d++)c.appendChild(m(a.children[d],b));for(var d in a.props)l(c,d,a.props[d])}return c}function n(a,b,c){for(var d in f(b,c)){var e=c[d],g='value'==d||'checked'==d?a[d]:b[d];e!==g&&l(a,d,e,g)}c.onupdate&&v.push(function(){c.onupdate(a,b)})}function o(a,b,c){function d(){a.removeChild(b)}c&&c.onremove?c.onremove(b,d):d()}function p(a,b,c,d,e,f){if(c===d);else if(null==c)b=a.insertBefore(m(d,e),b);else if(null!=d.type&&d.type===c.type){n(b,c.props,d.props),e=e||'svg'===d.type;for(var g=d.children.length,h=c.children.length,l={},q=[],r={},s=0;s<h;s++){var i=q[s]=b.childNodes[s],t=c.children[s],u=k(t);null!=u&&(l[u]=[i,t])}for(var s=0,v=0;v<g;){var i=q[s],t=c.children[s],j=d.children[v],u=k(t);if(r[u]){s++;continue}var w=k(j),x=l[w]||[];null==w?(null==u&&(p(b,i,t,j,e),v++),s++):(u===w?(p(b,x[0],x[1],j,e),s++):x[0]?(b.insertBefore(x[0],i),p(b,x[0],x[1],j,e)):p(b,i,null,j,e),v++,r[w]=j)}for(;s<h;){var t=c.children[s],u=k(t);null==u&&o(b,q[s],t.props),s++}for(var s in l){var x=l[s],y=x[1];r[y.props.key]||o(b,x[0],y.props)}}else b&&d!==b.nodeValue&&('string'==typeof d&&'string'==typeof c?b.nodeValue=d:(b=a.insertBefore(m(d,e),f=b),o(a,f,c.props)));return b}function q(c){for(s=!s,i(c=a.view(w))&&(c=c(x)),s||(t=p(b,t,u,u=c));c=v.pop();)c()}function r(){a.view&&!s&&setTimeout(q,s=!s)}var s,t=(b=b||document.body).children[0],u=c(t,[].map),v=[],w=a.state||{},x={};return r(j(w,x,a.actions,[])),x}({state:Oa,actions:{updateData:(a)=>(b)=>{const c=a.rooms[ha.roomId].optimistic;return Object.assign({},b,{me:a.me},{posts:c})},updateSort:(a)=>(b)=>Object.assign({},b,{sort:a.target.value}),setPath:(a)=>(b)=>Object.assign({},b,{path:a})},view:(a)=>(b)=>{const c=Object.assign({},b,Na);return d('div',{class:'upsense'},d(Ja,{me:a.me,goto:c.goto}),d(Ia,{state:a,actions:c}))}},Pa);((a)=>{Ka=a,Ka.setPath(Ma(window.location.pathname||'/')),window.onpopstate=(a)=>{const b=a.pathname||window.location.pathname||'/';Ka.setPath(Ma(b))}})(Qa),ja.subscribe(Qa.updateData)},function(a,b,c){const d=c(6),e=c(1);a.exports=(a={},b)=>{const c=b.postId;if(!c)return a;if(!e(b.$user))return a;const f=d(a[c],b);if(!f){const b=Object.assign({},a);return delete b[c],b}return Object.assign({},a,{[c]:d(a[c],b)})}},function(a,b,c){const d=c(7),{COMMENT:e,CREATE:f,DELETE_COMMENT:g,DELETE_POST:h,UPDATE:i,VOTE:j,OPEN:k}=c(0),l=c(2);a.exports=(a={votes:{}},b)=>{switch(b.type){case f:return a.owner?a:{postId:b.postId,title:b.title,description:b.description,owner:{userId:b.$userId,name:b.$user.name},createdAt:b.$timeMs,updatedAt:b.$timeMs,status:k,total:0,comments:[]};case i:return l(b.$user)?Object.assign({},a,{title:b.title,description:b.description,updatedAt:b.$timeMs,status:b.status}):a;case j:{const c=d(a.votes,b),e=Object.values(c);return Object.assign({},a,{votes:c,total:e.reduce((a,b)=>a+b,0)})}case e:{if(!b.text||4>=b.text.length)return a;const c=a.comments.slice();return c.push({user:{userId:b.$userId,name:b.$user.name},text:b.text}),Object.assign({},a,{comments:c})}case g:{if(!l(b.$user))return a;const c=a.comments.slice();return c.splice(b.index,1),Object.assign({},a,{comments:c})}case h:return l(b.$user)?void 0:a;default:return a;}}},function(a,b,c){const{VOTE:d}=c(0);a.exports=(a={},b)=>{switch(b.type){case d:return a[b.$userId]?Object.assign({},a,{[b.$userId]:0}):Object.assign({},a,{[b.$userId]:1});default:return a;}}},function(){}]);